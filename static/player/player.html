<html>
	<head>
		<title>mdvd player</title>
	</head>
	<body>
		<h1>mdvd</h1>
		<video id="dvdstream" src="http://10.0.1.63:8090/dvd.webm">
		</video>

		<button onClick="dvdstream.play()">enable</button>

		<br/>

		<button onClick="sendCommand('play')">play</button>
		<button onClick="sendCommand('stop')">stop</button>
		<button onClick="sendCommand('pause')">pause</button>
		<button onClick="sendCommand('resume')">resume</button>
		<button onClick="sendCommand('menu')">menu</button>
		<button onClick="sendCommand('up')">up</button>
		<button onClick="sendCommand('down')">down</button>
		<button onClick="sendCommand('left')">left</button>
		<button onClick="sendCommand('right')">right</button>
		<button onClick="sendCommand('select')">select</button>
		<button onClick="sendCommand('previous')">previous</button>

		<script>

			function sendCommand(command){

				// send http request to api to issue pause

				console.log('sending ' + command + ' command');

				// used to prevent fetching the stream before playback,
				// and also to work around mobile device limitations
				if(command === 'play'){
					dvdstream.play();
				}

				// handle pausing client-side so we can continue to
				// buffer data for playback
				if(command === 'pause'){
					dvdstream.pause();
				}

				if(command === 'resume'){
					dvdstream.play();
				}

				var pauseReq = new XMLHttpRequest();
				
				pauseReq.onreadystatechange = commandResponse;
				pauseReq.open('GET', '/command/' + command, true);
				pauseReq.send();

				function commandResponse(){
					
					console.log(this.readyState);

					if(this.readyState == 4){
						if(this.status == 200){
							
							console.log(command + ' request sucessful');

							console.log(this.responseText);
						}
					}
				}
			}

		</script>
	</body>
</html>

